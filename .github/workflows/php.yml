name: PHP Composer

on:
  push:
    branches: ["main"]
  pull_request:
    branches: ["main"]

permissions:
  contents: read

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      # Skip composer validate if composer.json doesn't exist
      - name: Validate composer.json (if exists)
        run: |
          if [ -f composer.json ]; then
            composer validate --strict
          else
            echo "composer.json not found — skipping validation."
          fi

      # Skip install if no composer.json file
      - name: Install dependencies (if composer.json exists)
        run: |
          if [ -f composer.json ]; then
            composer install --prefer-dist --no-progress
          else
            echo "composer.json not found — skipping composer install."
          fi
